<%@ page session="true" language="java" contentType="text/html; charset=euc-kr" pageEncoding="euc-kr"%><%/*** 프로젝트명	: 하도급거래 서면실태조사 지원을 위한 개발용역 사업* 프로그램명	: pollboard.jsp* 프로그램설명	: 기타조사 메인* 프로그램버전	: 1.0.1* 최초작성일자	: 2009년 05월* 작 성 이 력       :*=========================================================*	작성일자		작성자명				내용*=========================================================*	2009-05-00	정광식       최초작성*	2011-10-18	정광식		웹관리툴 리뉴얼*	2016-01-22	민현근		DB변경으로 인한 인코딩 변경*/%><%@ page import="java.sql.*"%><%@ page import="java.util.*"%><%@ page import="ftc.util.*"%><%@ page import="ftc.db.ConnectionResource"%><%@ page import="ftc.db.ConnectionResource2"%><%@ page import="java.text.DecimalFormat"%><%@ include file="/hado/wTools/inc/WB_I_Global.jsp"%><%@ include file="/hado/wTools/inc/WB_I_chkMngSession.jsp"%><%/*---------------------------------------- Variable Difinition ----------------------------------------*/	// 담당조사관정보추가 // 20100503 / 정광식	ArrayList arrDamCenter = new ArrayList();	ArrayList arrUserName = new ArrayList();	ArrayList arrDeptName = new ArrayList();	ArrayList arrCVSNo = new ArrayList();	// 제조 업종배열	ArrayList arrDCode = new ArrayList();	ArrayList arrDName = new ArrayList();	// 건설 업종배열	ArrayList arrCCode = new ArrayList();	ArrayList arrCName = new ArrayList();	// 용역 업종배열	ArrayList arrSrvCode = new ArrayList();	ArrayList arrSrvName = new ArrayList();	// 담당자 배열	ArrayList arrDeptSeq = new ArrayList();	ArrayList arrDeptCode = new ArrayList();	ArrayList arrDamName = new ArrayList();	ConnectionResource resource = null;	Connection conn = null;	PreparedStatement pstmt = null;	ResultSet rs = null;	int sStartYear = 2000;	int i = 0;	int gesu = 0;	DecimalFormat formater = new java.text.DecimalFormat("###,###,###,###,###,###,###,###");/*-----------------------------------------------------------------------------------------------------*//*=================================== Record Selection Processing =====================================*/	int currentYear = st_Current_Year_n;	try {		resource = new ConnectionResource();		conn = resource.getConnection();		// 제조 업종 배열 생성		StringBuffer sbSQLs1 = new StringBuffer();		sbSQLs1.append("SELECT COMMON_CD, COMMON_NM \n");		sbSQLs1.append("FROM COMMON_CD \n");		sbSQLs1.append("WHERE ADDON_GB=?");		pstmt = conn.prepareStatement(sbSQLs1.toString());		pstmt.setString(1,"1");		rs = pstmt.executeQuery();		while (rs.next()) {			arrDCode.add(StringUtil.checkNull(rs.getString("COMMON_CD")).trim());			arrDName.add(StringUtil.checkNull(rs.getString("COMMON_NM")).trim());		}		rs.close();		// 건설 업종 배열 생성		pstmt = conn.prepareStatement(sbSQLs1.toString());		pstmt.setString(1,"2");		rs = pstmt.executeQuery();		while (rs.next()) {			arrCCode.add(StringUtil.checkNull(rs.getString("COMMON_CD")).trim());			arrCName.add(StringUtil.checkNull(rs.getString("COMMON_NM")).trim());		}		rs.close();		// 용역 업종 배열 생성		pstmt = conn.prepareStatement(sbSQLs1.toString());		pstmt.setString(1,"3");		rs = pstmt.executeQuery();		while (rs.next()) {			arrSrvCode.add(StringUtil.checkNull(rs.getString("COMMON_CD")).trim());			arrSrvName.add(StringUtil.checkNull(rs.getString("COMMON_NM")).trim());		}		rs.close();		// 2010년 담당자 세팅 방법 변경 (HADO_TB_DEPT_HISTORY)		StringBuffer sbSQLs2 = new StringBuffer();		if( st_Current_Year_n>= 2010) {			sbSQLs2.append("SELECT CVSNO DEPT_SEQ, Center_Name,User_Name \n");			sbSQLs2.append("FROM HADO_TB_DEPT_HISTORY \n");			sbSQLs2.append("WHERE Current_Year=? \n");			sbSQLs2.append("GROUP BY CVSNO, Center_Name, User_Name \n");			sbSQLs2.append("ORDER BY Center_Name, User_Name");		} else {			// 담당자별 배열 생성			sbSQLs2.append("SELECT DEPT_SEQ, CENTER_NAME, USER_NAME FROM HADO_TB_FTC_USER \n");			sbSQLs2.append("ORDER BY CENTER_NAME, USER_NAME");		}		pstmt = conn.prepareStatement(sbSQLs2.toString());		if( st_Current_Year_n>= 2010) {			pstmt.setString(1,st_Current_Year);		}		rs = pstmt.executeQuery();		while(rs.next()) {			arrDeptSeq.add(StringUtil.checkNull(rs.getString("DEPT_SEQ")).trim());			arrDeptCode.add(selDeptCode(StringUtil.checkNull(rs.getString("CENTER_NAME")).trim()));			arrDamName.add(StringUtil.checkNull(rs.getString("USER_NAME")).trim());		}		rs.close();	}	catch(Exception e){		e.printStackTrace();	}	finally {		if ( rs != null ) try{rs.close();}catch(Exception e){}		if ( pstmt != null ) try{pstmt.close();}catch(Exception e){}		if ( conn != null ) try{conn.close();}catch(Exception e){}		if ( resource != null ) resource.release();	}/*=====================================================================================================*/%><%!	public String selDeptCode(String str){		String sReturnStr = "";		if(str.equals("서울사무소") || str.equals("서울 사무소") ){			sReturnStr = "S";		}else if(str.equals("대구사무소") || str.equals("대구 사무소")){			sReturnStr = "K";		}else if(str.equals("대전사무소") || str.equals("대전 사무소")){			sReturnStr = "J";		}else if(str.equals("광주사무소") || str.equals("광주 사무소")){			sReturnStr = "G";		}else if(str.equals("부산사무소") || str.equals("부산 사무소") ){			sReturnStr = "B";		}else{			sReturnStr = "H";		}		return sReturnStr ;	}%><html><head>	<title>【관리】하도급거래 서면실태조사</title>	<link rel="stylesheet" href="/hado/hado/wTools/style.css" type="text/css">	<script language="javascript" type="text/javascript" src="/hado/hado/wTools/inc/ajax_layer.js"></script>	<script language="javascript" type="text/javascript" src="/hado/hado/wTools/inc/common_script.js"></script></head><body>	<div id="ajax_ready" style="position:absolute;top:1px;left:1px;width:60px;height:60px;display:none;z-index:99;"><img src="/hado/hado/wTools/img/ajax_ani.gif" border="0"></div>	<div id="ajax_bg" style="position:absolute;top:1px;left:1px;display:none;background:url(/hado/hado/wTools/img/ajax_bg.gif);z-index:51;"></div>	<div id="container">		<!-- Begin Header -->		<%@ include file="/hado/wTools/inc/WB_I_pageTop.jsp"%>		<!-- End Header -->		<!-- Begin Main-menu -->		<jsp:include page="/hado/wTools/inc/WB_I_topMenu.jsp">		<jsp:param value="08" name="sel"/>		</jsp:include>		<!-- End Main-menu -->		<!-- Begin Contents -->		<div id="wrapper">			<div id="contents">				<!-- Begin Left-menu -->				<jsp:include page="/hado/wTools/inc/WB_I_poll_LMenu.jsp">				<jsp:param value="001" name="sel"/>				</jsp:include>				<!-- End Left-menu -->				<div id="divContent">					<div id="divResult">					</div>					<div id="divView" onMouseDown="f_DragMDown(this)">					</div>				</div>				<iframe src="about:blank" width="1" height="1" id="procFrame" name="procFrame" style="display:none;"></iframe>			</div>		</div>		<!-- End Contents -->		<!-- Begin Footer -->		<%@ include file="/hado/wTools/inc/WB_I_Copyright.jsp"%>		<!-- End Footer -->	</div></body></html>